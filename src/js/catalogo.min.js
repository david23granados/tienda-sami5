const ESQUELETO_PRODUCTO=`<div class="sm-col-30"><figure class="card card-product-grid"><div class="img-wrap">[[porcentaje]][[tag_nuevo]]<a href="/[[url_producto]]" aria-label="Ver detalle del producto"><img src="[[imagen_principal]]" class="sm-responsive-img" alt="[[titulo_producto]]"></a><a class="btn btn-block btn-primary btn_subt" name="[[sku]]" data-idprd="[[id_producto]]">VISTA PREVIA</a></div><figcaption class="info-wrap"><div class="fix-height"><a href="/[[url_producto]]" class="titles">[[titulo_producto]]</a><div class="price-wrap mt-2 text-center">[[precios]]</div></div></figcaption></figure></div>`,Pages=window.location.pathname,PageSplit=Pages.replace(" ","-").toLowerCase().split("/"),ordm=sessionStorage.getItem("ORD"),defaultOrdnn="&rlv=true",ordnn=ordm?`&${ordm}`:defaultOrdnn;ordm||sessionStorage.setItem("ORD",defaultOrdnn.substring(1));const store_dominio=PageSplit[1],cat_categoria=PageSplit[2],ulwd=window.location.search.substring(1),LIMIT="limit=12",CATEGORY_PREFIX="categoria",SEARCH_PREFIX="busqueda",url=location.href,urlObj=new URL(url),searchParams=urlObj.searchParams,param1=searchParams.get("f");let params;if(param1)params=`busqueda/${param1}/?=${ulwd?"&"+ulwd:""}${LIMIT}${ordnn}`;else{let t=`${ulwd?ulwd+"&":""}${LIMIT}${ordnn}`;params=cat_categoria?`${CATEGORY_PREFIX}/${store_dominio}/${cat_categoria}?${t}`:`${CATEGORY_PREFIX}/${store_dominio}?${t}`}var settings={url:`${API_CATALOGO}${params}`,method:"GET",timeout:0};$(document).ready(function(){$.ajax(settings).done(function(t){let a=t.obj[0].total_de_registros;t.obj[0].datos_catalogos.forEach(t=>{let a=void 0!=t.tag?`<div class"tag_nuevo">${t.tag}</div>`:"",o="",e="";if(t.precio_oferta_maxima==t.precio_venta_maxima)o=`<span class="price">${MODENA_PRINCIPAL} ${t.precio_venta_maxima}</span>`;else{let i=100*t.precio_oferta_maxima;i/=t.precio_venta_maxima,i=100-i,o=`<del class="price-old">${MODENA_PRINCIPAL} ${t.precio_venta_maxima}</del><span class="price_offer">Ahora ${MODENA_PRINCIPAL} ${t.precio_oferta_maxima}</span>`,e=`<span class="badge badge-danger">-${parseInt(i)}%</span>`}$(".conten-card").append(ESQUELETO_PRODUCTO.replaceAll("[[porcentaje]]",e).replaceAll("[[tag_nuevo]]",a).replaceAll("[[url_producto]]",t.url_producto).replaceAll("[[imagen_principal]]",t.item_url).replaceAll("[[sku]]",t.sku_padre).replaceAll("[[id_producto]]",t.idProducto).replaceAll("[[titulo_producto]]",t.item_title).replaceAll("[[precios]]",o))}),$(".placeholder").remove(),$(".conten-card").removeClass("d-none"),sessionStorage.setItem("registros_totales",a);let o=sessionStorage.getItem("registros_totales"),e=sessionStorage.getItem("numero_pagina");if(e&&ulwd){let i=12*e-11,r=12*e;$("#vista_productos").html(`<b>Mostrando ${i} - ${r} de ${o} Productos</b>`)}else{e=1,sessionStorage.setItem("enlace2","page=1"),sessionStorage.setItem("numero_pagina","1");let s=$("#contenedor_catalogo > div").length;$("#vista_productos").html(`<b>Mostrando 1 - ${s} de ${a} Productos</b>`)}$("#paginacion-cat").pagination({items:o,itemsOnPage:12,displayedPages:3,cssStyle:"light-theme",currentPage:e,hrefTextPrefix:"",ellipsePageSet:!1,prevText:"\xab",nextText:"\xbb",onPageClick:function(t,a){a.preventDefault();var o=[],e=t;o=$.grep(o,function(t){return 0!==t.indexOf("page=")});var i=sessionStorage.getItem("ORD");null!=i&&o.push(i),sessionStorage.setItem("enlace2","page="+e);var r=sessionStorage.getItem("enlace2");sessionStorage.setItem("numero_pagina",e),o.push(r);var s=o.join("&");window.location.href=Pages+"?"+s}})}).fail(function(t){let a=`<h4>No encontramos coincidencias <span>con tu b\xfasqueda</span></h4><div class="text-muted">0 resultados para "<b>${param1}</b>"<br><div class="btn_opciones"><a href="/"> <button type="button" class=" btn btn-dark">Volver a Inicio</button></a></div></div>`;"no se encontro categoria"==t.responseJSON.sRpta&&(a=`<h4>No encontramos ningun producto</h4><br><div class="btn_opciones"><a href="http://samishop5.s1a2m3i4.com/login/?redirect=home#!/auth-login/"> <button type="button" class=" btn btn-dark">Volver a Inicio</button></a></div>`),$(".contenido_catalogo").remove(),$(".section-pagetop").html(`<div class="container error_section"><div class="row"><div class="col-md-12 text-center">${a}</div></div></div>`),$(".section-pagetop").show(),sessionStorage.setItem("enlace2","page=1"),sessionStorage.setItem("numero_pagina","1")});var t=sessionStorage.getItem("ORD");function a(t,a,o,e){var i={url:`${API_SELFROM_MODAL}${DOMINIO}/idproducto/${e}`,method:"GET",timeout:0};jQuery.ajax(i).done(function(i){let r=i.obj.datos_variaciones,s="";r.forEach(i=>{let r=i.atributo1_valor,l=i.atributo2_valor,n=i.atributo3_valor;if(r===t&&l===a&&n===o){let d=`[data-id="${e}"]`,c=i.sku;$("#product_quantity"+d).attr("name",c),$("#button-plus6"+d).attr("name",c),$("#button-minus6"+d).attr("name",c),$("#product-add-cart6"+d).attr("name",c),$("#product-cart-message"+d).attr("name",c);let u;if(i.price===i.sale_price)u=`<div><span class="price">${MODENA_PRINCIPAL} ${parseFloat(i.price).toFixed(2)}</span></div>`;else{let p=i.sale_price/i.price*100-100;u=`<div><del class="price-old">${MODENA_PRINCIPAL} ${parseFloat(i.price).toFixed(2)}</del></div><div><span class="price">Ahora ${MODENA_PRINCIPAL} ${parseFloat(i.sale_price).toFixed(2)}</span></div><span class="badge badge-danger">-${parseInt(p)}%</span>`}let m=[i.url1_imagen_sku,i.url2_imagen_sku,i.url3_imagen_sku,i.url4_imagen_sku,i.url5_imagen_sku,i.url6_imagen_sku];m.forEach(t=>{""!==t&&(s+=`<img src="${t}" class="img_full">`)}),$(".section_precio6").html(u),$(".img_prdh_pe").html(s),$("#detalleProducto1 .img_prdh img").attr("src",i.url1_imagen_sku);return}})})}null!=t&&("new=true"==t?$(".list_ordenar").val("NEW"):"rlv=true"==t?$(".list_ordenar").val("REL"):"ofert_max=true"==t?$(".list_ordenar").val("MAX"):"ofert_min=true"==t&&$(".list_ordenar").val("MIN")),$(".list_ordenar").change(function(){var t=$(this).val(),a=[];"NEW"==t?sessionStorage.setItem("ORD","new=true"):"REL"==t?sessionStorage.setItem("ORD","rlv=true"):"MAX"==t?sessionStorage.setItem("ORD","ofert_max=true"):"MIN"==t&&sessionStorage.setItem("ORD","ofert_min=true");var o=sessionStorage.getItem("ORD");null!=o&&a.push(o),sessionStorage.setItem("enlace2","page=1");var e=sessionStorage.getItem("enlace2");sessionStorage.setItem("numero_pagina","1"),a.push(e);var i=a.join("&");window.location.href=Pages+"?"+i}),$(document).on("click",".btn_subt",function(){var t=$(this).attr("data-idprd"),a={url:`${API_SELFROM_MODAL}${DOMINIO}/idproducto/${t}`,method:"GET",timeout:0};jQuery.ajax(a).done(function(a){a.obj.datos_variaciones[0].cantidad;var o=a.obj.datos_Catalogo[0].item_title,e=a.obj.datos_Catalogo[0].item_url,i=a.obj.datos_variaciones[0].price,r=a.obj.datos_variaciones[0].sale_price,s=a.obj.datos_variaciones[0].sku_padre;let l=[a.obj.datos_variaciones[0].url1_imagen_sku,a.obj.datos_variaciones[0].url2_imagen_sku,a.obj.datos_variaciones[0].url3_imagen_sku,a.obj.datos_variaciones[0].url4_imagen_sku,a.obj.datos_variaciones[0].url5_imagen_sku,a.obj.datos_variaciones[0].url6_imagen_sku],n=a.obj.datos_variaciones,d=n[0],c=l.map(t=>{}).join("");$(".img_prdh_pe").html(c);let u,p;u=`<div class="price-wrap mt-2 section_precio6"><span class="price">${MODENA_PRINCIPAL} ${p=i==r?parseFloat(i).toFixed(2):`<span>${parseFloat(r).toFixed(2)}</span><del>${MODENA_PRINCIPAL} ${parseFloat(i).toFixed(2)}</del><span class="badge badge-danger">-${(100-r/i*100).toFixed(0)}%</span>`}</span></div>`;s=d.sku;let m="";if(1===n.length)m="";else if(n.length>1){let v=new Set;if(n.forEach(t=>{v.add(t.atributo1_valor)}),m=`<label>${d.atributo1_titulo}</label><select class="form-control" id="prd_variacion6" data-id="${t}" name="1">${Array.from(v).map(t=>`<option value="${t}">${t}</option>`)}</select>`,d.atributo2_titulo){let g=new Set;n.forEach(t=>{t.atributo1_valor===d.atributo1_valor&&g.add(t.atributo2_valor)}),m+=`<label>${d.atributo2_titulo}</label><select class="form-control" id="prd_variacion2" data-id="${t}" name="2">${Array.from(g).map(t=>`<option value="${t}">${t}</option>`)}</select>`}if(d.atributo3_titulo){let b=new Set;n.forEach(t=>{t.atributo1_valor===d.atributo1_valor&&t.atributo2_valor===d.atributo2_valor&&b.add(t.atributo3_valor)}),m+=`<label>${d.atributo3_titulo}</label><select class="form-control" id="prd_variacion3" data-id="${t}" name="3">${Array.from(b).map(t=>`<option value="${t}">${t}</option>`)}   </select> `}}$("#detalleProducto1 .modal-header h5").html(o),$(".contenido_prd .img_prdh").html(`<img src="${e}" class="img_full">`),$(".contenido_prd .data_prdh").html(`${u}${m}<div class="price-wrap mt-2"><label class="form-label d-block">Cantidad</label><div class="input-group input_style input-spinner mb-2"><button class="btn btn-icon btn-light" type="button" id="button-minus6" name="${s}" data-id="${t}"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="#999" viewBox="0 0 24 24"><path d="M19 13H5v-2h14v2z"></path></svg></button><input class="form-control text-center" placeholder="" value="1" id="product_quantity" name="${s}" data-id="${t}"><button class="btn btn-icon btn-light" type="button" id="button-plus6" name="${s}" data-id="${t}"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="#999" viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg></button></div> <!-- input-group.// --><button type="button" class="btn_subtt6" id="product-add-cart6" name="${s}" data-id="${t}">Agregar al carrito</button><p id="product-cart-message" data-id="${t}" name="${s}"></p></div>`),$("#detalleProducto1").modal()})}),$(document).on("change","#prd_variacion6",function(){var t,o,e,i,r=$(this).attr("data-id"),s=$(this).val(),l=$("#detalleProducto1 #prd_variacion2[data-id='"+r+"']").val();t=s,o=l,i={url:`${API_SELFROM_MODAL}${DOMINIO}/idproducto/${e=r}`,method:"GET",timeout:0},jQuery.ajax(i).done(function(i){let r=i.obj.datos_variaciones,s=[],l="";r.forEach(a=>{-1===s.indexOf(a.atributo2_valor)&&a.atributo1_valor==t&&s.push(a.atributo2_valor)}),s.forEach(t=>{l+=`<option value="${t}"${t===o?" selected":""}>${t}</option>`}),$(`#detalleProducto1 #prd_variacion2[data-id="${e}"]`).html(l);let n=$(`#detalleProducto1 #prd_variacion2[data-id="${e}"]`).val()||"",d=$(`#detalleProducto1 #prd_variacion3[data-id="${e}"]`).val()||"";a(t,n,d,e)})}),$(document).on("change","#prd_variacion2",function(){var t,o,e,i,r=$(this).attr("data-id"),s=$(this).val();$("#detalleProducto1 #prd_variacion6").val(),o=s,e=r,i={url:API_SELFROM_MODAL+DOMINIO+"/idproducto/"+e,method:"GET",timeout:0},jQuery.ajax(i).done(function(t){let i=t.obj.datos_variaciones,r=[];i.forEach(t=>{r.includes(t.atributo3_valor)||t.atributo1_valor!==l||t.atributo2_valor!==o||r.push(t.atributo3_valor)});let s=r.map(t=>`<option value="${t}">${t}</option>`).join("");$(`#prd_variacion3[data-id="${e}"]`).html(s);let l=$("#detalleProducto1 #prd_variacion6").val(),n=$("#detalleProducto1 #prd_variacion3").val();l||(l=""),n||(n=""),a(l,o,n,e)})}),$(document).on("change","#prd_variacion3",function(){let t=this.dataset.id,o=this.value,e=$(`#prd_variacion6[data-id='${t}']`).val()||"",i=$(`#prd_variacion2[data-id='${t}']`).val()||"";a(e,i,o,t)}),$(document).on("click","#button-minus6",function(){let t=$(this).attr("name"),a=parseInt($("#product_quantity").val())-1,o=calculateValidQuantityMinus(t,a);!0===o?(asignateQuantityProductChange(t,a),$("[id='product-cart-message'][name='"+t+"']").text("")):asignateQuantityProductChange(t,1)}),$(document).on("keyup","#product_quantity",function(){let t=$(this).attr("name"),a=$(this).val();var o=$(this).attr("data-id");a=a<=0||null===a||""===a?1:parseInt(a),calculateValidQuantityKeypress(t,a,o)}),$(document).on("click","#button-plus6",function(){let t=$(this).attr("name"),a=parseInt($("#product_quantity").val())+1;var o=$(this).attr("data-id");calculateValidQuantityPlus(t,a,o)}),$(document).on("click",".btn_subtt6",async function(){let t=$(this).attr("name"),a=parseInt($("#product_quantity").val()),o=[{dominio:DOMINIO,sku:t}],e=await fetch("https://api-inventario.samishop.pe/datosvariaciones/validate/price_stock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(e.ok){let i=await e.json(),r={datos_Catalogo_item_title:i.sRpta[0].item_title,datos_Catalogo_tags_promociones:i.sRpta[0].tags_promociones,datos_Catalogo_url_producto:i.sRpta[0].url_producto,datos_variaciones_sku:i.sRpta[0].sku,datos_variaciones_price:i.sRpta[0].price,datos_variaciones_sale_price:i.sRpta[0].sale_price,datos_variaciones_cantidad:i.sRpta[0].cantidad,datos_variaciones_atributo1_titulo:i.sRpta[0].atributo1_titulo,datos_variaciones_atributo1_valor:i.sRpta[0].atributo1_valor,datos_variaciones_atributo2_titulo:i.sRpta[0].atributo2_titulo,datos_variaciones_atributo2_valor:i.sRpta[0].atributo2_valor,datos_variaciones_atributo3_titulo:i.sRpta[0].atributo3_titulo,datos_variaciones_atributo3_valor:i.sRpta[0].atributo3_valor,datos_variaciones_url1_imagen_sku:i.sRpta[0].url1_imagen_sku,datos_variaciones_peso:i.sRpta[0].peso,datos_variaciones_subtotal:i.sRpta[0].sale_price*a,quantity:a};var s={sku:r.datos_variaciones_sku,item_title:r.datos_Catalogo_item_title,price:r.datos_variaciones_price,sale_price:r.datos_variaciones_sale_price,quantity:a,cantidad:r.datos_variaciones_cantidad,atributo1_titulo:r.datos_variaciones_atributo1_titulo,atributo1_valor:r.datos_variaciones_atributo1_valor,atributo2_titulo:r.datos_variaciones_atributo2_titulo,atributo2_valor:r.datos_variaciones_atributo2_valor,atributo3_titulo:r.datos_variaciones_atributo3_titulo,atributo3_valor:r.datos_variaciones_atributo3_valor,observacion:"",tags_promociones:r.datos_Catalogo_tags_promociones,url1_imagen_sku:r.datos_variaciones_url1_imagen_sku,url_producto:r.datos_Catalogo_url_producto,subtotal:r.datos_variaciones_subtotal,peso:r.datos_variaciones_peso};if(null!=getCookie(PRODUCTOS_COOKIE)){let l=getCookie(PRODUCTOS_COOKIE),n=setProduct(l,s,r);null!=n?($("#product-cart-message").text(""),setCookie(PRODUCTOS_COOKIE,n,0)):$("#product-cart-message").text("No existe stock suficiente")}else if(!1===ValidateSetCartProduct(a,r.datos_variaciones_cantidad))$("#product-cart-message").text("No existe stock suficiente"),$("#detalleProducto").modal();else{let d={products:[],summary:{subTotal:0,disccount:0,quantity:0,total:0}};d.products.push(s),$("#product-cart-message").text(""),$("#detalleProducto").modal(),setCookie(PRODUCTOS_COOKIE,d,0)}(function t(){$("#detalleProducto #nombre_producto").text(r.datos_Catalogo_item_title),$("#detalleProducto #product-title-modal").text(r.datos_Catalogo_item_title),$("#detalleProducto #product-quantity-modal").text(a);for(var o=1;o<=3;o++){var e=r["datos_variaciones_atributo"+o+"_titulo"],i=r["datos_variaciones_atributo"+o+"_valor"];""!==e&&""!==i&&($("#detalleProducto #product-modal-variation-title-"+o).html("<b>"+e+"</b>:"),$("#detalleProducto #product-modal-variation-value-"+o).html(" "+i))}$("#detalleProducto #product-sku-modal").text(r.datos_variaciones_sku),$("#detalleProducto #product-image-modal").attr("src",r.datos_variaciones_url1_imagen_sku),$("#detalleProducto #product-subtotal-modal").text(parseFloat(r.datos_variaciones_subtotal).toFixed(2))})(),carritoResumen(),$(".close, [data-dismiss=modal]").click(),$("#detalleProducto").modal()}}),$(document).on("click",".img_prdh_pe img",function(){$(".img_prdh img").attr("src",$(this).attr("src"))}),$(".img_prdh_pe img").hover(function(){$(".img_prdh img").attr("src",$(this).attr("src"))})});